<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Audit Follow-Up Tracking App · Admin</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app app--ros-admin">
      <aside class="sidebar">
        <div class="brand">
          <span class="brand-mark">AF</span>
          <div>
            <h1>Audit Follow-Up</h1>
            <p>Tracking Workspace</p>
          </div>
        </div>
        <nav class="nav">
          <button class="nav-item active" data-screen="home">Home</button>
          <button class="nav-item" data-screen="create-audit">Create Audit</button>
          <button class="nav-item" data-screen="create-tasks">Create Templates</button>
          <button class="nav-item" data-screen="task-list">Task List</button>
          <button class="nav-item" data-screen="task-detail">Task Detail</button>
          <button class="nav-item" data-screen="reviewer-queue">Reviewer Queue</button>
          <button class="nav-item" data-screen="store-manager">Store Manager</button>
          <button class="nav-item admin-only" data-screen="admin">Admin Panel</button>
        </nav>
        <div class="sidebar-metrics" id="sidebar-metrics"></div>
        <div class="sidebar-footer hidden" id="sidebar-footer">
          <p>Store Code: <strong id="sidebar-store-code">--</strong></p>
          <p>Status: <span class="status-pill" id="sidebar-audit-status">Open</span></p>
        </div>
      </aside>
      <main class="main">
        <header class="topbar">
          <div>
            <h2 id="screen-title">Home</h2>
            <p id="screen-subtitle">Search and start a new audit follow-up.</p>
          </div>
          <div class="topbar-actions">
            <button class="secondary admin-only" id="generate-report-button">Generate Report</button>
            <button class="primary" id="new-audit-button">New Audit</button>
          </div>
        </header>

        <section class="content" id="screen-home">
          <div class="grid three">
            <div class="card metric-card">
              <p class="eyebrow">Open Audits</p>
              <strong class="metric-value" id="home-open-audits">0</strong>
              <p class="muted">Audits still in progress.</p>
            </div>
            <div class="card metric-card">
              <p class="eyebrow">Overdue Audits</p>
              <strong class="metric-value danger" id="home-overdue-audits">0</strong>
              <p class="muted">Audits with overdue tasks.</p>
            </div>
            <div class="card metric-card">
              <p class="eyebrow">Waiting Approval</p>
              <strong class="metric-value" id="home-awaiting-approval">0</strong>
              <p class="muted">Proofs pending reviewer action.</p>
            </div>
          </div>
          <div class="grid two">
            <div class="card">
              <h3>Find Audits</h3>
              <div class="filter-grid">
                <label class="field">
                  Status
                  <select id="home-filter-status">
                    <option value="all">All</option>
                    <option value="open">Open</option>
                    <option value="overdue">Overdue</option>
                    <option value="completed">Completed</option>
                  </select>
                </label>
                <label class="field">
                  Owner
                  <select id="home-filter-owner"></select>
                </label>
                <label class="field">
                  Store
                  <select id="home-filter-store"></select>
                </label>
                <label class="field">
                  From
                  <input id="home-filter-start" type="date" />
                </label>
                <label class="field">
                  To
                  <input id="home-filter-end" type="date" />
                </label>
              </div>
              <div class="table">
                <div class="table-row header">
                  <span>Audit</span>
                  <span>Store</span>
                  <span>Owner</span>
                  <span>Tasks</span>
                  <span>Status</span>
                </div>
                <div id="home-audit-rows"></div>
              </div>
            </div>
            <div class="card">
              <h3>Recent Activity</h3>
              <div class="timeline">
                <div class="timeline-item">
                  <span class="dot"></span>
                  <div>
                    <p><strong>Proof submitted</strong> for “Emergency Exit signage”</p>
                    <span>2 hours ago · Submission #2</span>
                  </div>
                </div>
                <div class="timeline-item">
                  <span class="dot warning"></span>
                  <div>
                    <p><strong>Reminder sent</strong> to SM & RM for 3 tasks due in 7 days</p>
                    <span>Yesterday · D-7 rule</span>
                  </div>
                </div>
                <div class="timeline-item">
                  <span class="dot success"></span>
                  <div>
                    <p><strong>Audit AUD-2025-001 created</strong></p>
                    <span>Feb 12, 2025</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <section class="content hidden" id="screen-create-audit">
          <div class="card">
            <h3>Create Audit Follow-Up</h3>
            <div class="grid two">
              <label class="field">
                Audit Identifier
                <input id="audit-id-input" type="text" value="AUD-2025-001" />
              </label>
              <label class="field">
                Audit Date
                <input id="audit-date-input" type="date" value="2025-02-12" />
              </label>
              <label class="field">
                Audit Completed By
                <input id="audit-owner-input" type="text" value="Jamie Chen" />
              </label>
              <label class="field">
                Store Name
                <input id="audit-store-input" type="text" value="Toronto Midtown" />
              </label>
              <label class="field">
                Assignee
                <input id="audit-assignee-input" type="text" list="assignee-list" value="Sam Thompson" />
              </label>
              <label class="field">
                Follow-up Due Date
                <input id="audit-deadline-input" type="date" value="2025-03-08" />
              </label>
              <label class="field">
                Reminder cadence (days before deadline)
                <input id="audit-reminder-input" type="number" min="0" value="7" />
              </label>
              <label class="field">
                Language
                <select id="audit-language-select">
                  <option value="en">English</option>
                  <option value="fr">French</option>
                </select>
              </label>
              <label class="field">
                Audit App Link
                <input
                  id="audit-app-link-input"
                  type="text"
                  value="https://followup.contoso.com/app/audits/AUD-2025-001"
                />
              </label>
            </div>
            <label class="field">
              AI Summary
              <textarea id="audit-summary-input" rows="4">Store passed 14/20 categories. Key gaps: emergency exit signage, stock room labeling, and fire extinguisher checks.</textarea>
            </label>
            <label class="field">
              Audit Photos Folder Link
              <input id="audit-photos-input" type="text" value="https://sharepoint/ProofLibrary/Proof/AUD-2025-001" />
            </label>
            <div class="actions">
              <button class="secondary" id="save-draft-button">Save Draft</button>
              <button class="primary" id="save-continue-button">Save & Continue</button>
            </div>
            <div class="alert info hidden" id="audit-draft-alert">
              <span id="audit-draft-message">Draft saved locally.</span>
              <span class="muted" id="audit-draft-timestamp"></span>
            </div>
          </div>
          <div class="card">
            <h3>Audit Email Preview</h3>
            <p class="muted">Generated when you save the audit follow-up.</p>
            <pre id="audit-email-preview" class="preview-card">Preview will appear here.</pre>
            <div class="section">
              <h4>Send activity</h4>
              <div id="audit-email-send-log" class="stack muted">No audit emails sent yet.</div>
            </div>
            <div class="section">
              <h4>Notification activity</h4>
              <div id="audit-notification-log" class="stack muted">No notifications dispatched yet.</div>
            </div>
          </div>
          <div class="card">
            <h3>Audit Task Assignments</h3>
            <p class="muted">Assign task templates to this audit. Drag to reorder and add manager notes.</p>
            <div class="task-assignment">
              <label class="field">
                Add task template
                <select id="existing-task-select"></select>
              </label>
              <button class="secondary" id="add-existing-task">Add template</button>
            </div>
            <div class="task-summary">
              <div class="task-summary-header">
                <strong>Audit task summary</strong>
                <span class="muted" id="audit-task-count"></span>
              </div>
              <div class="audit-task-list" id="audit-task-summary"></div>
            </div>
          </div>
        </section>

        <section class="content hidden" id="screen-create-tasks">
          <div class="grid two">
            <div class="card">
              <h3>Create Task Template</h3>
              <label class="field">
                Template Title
                <input id="task-title-input" type="text" value="Emergency exit signage" />
              </label>
              <label class="field">
                Category
                <input id="task-category-input" type="text" value="Loss Prevention" />
              </label>
              <label class="field">
                Template Notes
                <textarea id="task-notes-input" rows="3">Ensure all emergency exits have clear signage and no obstructions.</textarea>
              </label>
              <label class="field field-inline">
                <input id="task-proof-required-input" type="checkbox" checked />
                Proof required
              </label>
              <button class="primary full" id="add-task-button">Add Task</button>
            </div>
            <div class="card">
              <h3>Suggested Templates</h3>
              <div class="chip-list">
                <span class="chip" data-category="Loss Prevention">Emergency exit signage</span>
                <span class="chip" data-category="Store Appearance">Stock room labeling</span>
                <span class="chip" data-category="Safety">Fire extinguisher inspection</span>
              </div>
              <button class="secondary full" id="bulk-add-button">Bulk Add (3)</button>
            </div>
            <div class="card">
              <h3>Template Library</h3>
              <p class="muted">Templates can be reused across multiple audits.</p>
              <div class="task-pool" id="task-pool-list"></div>
            </div>
          </div>
        </section>

        <section class="content hidden" id="screen-task-list">
          <div class="card">
            <div class="table-header">
              <h3>Task List</h3>
              <div class="filter-group">
                <button class="filter active">All</button>
                <button class="filter">Not Started</button>
                <button class="filter">Proof Submitted</button>
                <button class="filter">Overdue</button>
              </div>
            </div>
            <div class="table">
              <div class="table-row header">
                <span>Task</span>
                <span>Category</span>
                <span>Due</span>
                <span>Assigned</span>
                <span>Status</span>
              </div>
              <div id="task-list-rows"></div>
            </div>
          </div>
        </section>

        <section class="content hidden" id="screen-task-detail">
          <div class="grid two">
            <div class="card">
              <h3>Task Details</h3>
              <ul class="details">
                <li><span>Task</span><strong id="detail-task-title"></strong></li>
                <li><span>Category</span><strong id="detail-task-category"></strong></li>
                <li><span>Audit</span><strong id="detail-task-audit"></strong></li>
                <li><span>Due Date</span><strong id="detail-task-due"></strong></li>
                <li><span>Assigned To</span><strong id="detail-task-assignee"></strong></li>
                <li><span>Assignee Email</span><strong id="detail-task-email"></strong></li>
                <li><span>Proof Required</span><strong id="detail-task-proof"></strong></li>
                <li><span>Status</span><strong id="detail-task-status"></strong></li>
                <li><span>Submission #</span><strong id="detail-task-submission"></strong></li>
              </ul>
              <label class="field">
                Manager Notes
                <textarea id="detail-manager-notes" rows="3" placeholder="Add instructions for the store manager..."></textarea>
              </label>
              <label class="field">
                Reviewer Notes
                <textarea id="detail-reviewer-notes" rows="4" placeholder="Add approval or rejection feedback..."></textarea>
              </label>
              <div class="actions">
                <button class="secondary" id="reject-task">Reject</button>
                <button class="primary" id="approve-task">Approve</button>
              </div>
            </div>
            <div class="card">
              <h3>Proof Submission</h3>
              <p class="muted">
                Store managers upload proof photos here. Uploads stay in draft until you submit proof to the
                reviewer queue.
              </p>
              <label class="field">
                Store Manager Notes
                <textarea id="proof-notes" rows="3" placeholder="Add notes for the reviewer..."></textarea>
              </label>
              <div class="upload-box">
                <div>
                  <h4>Upload proof photos</h4>
                  <p>Drag & drop or browse files. JPG/PNG up to 10MB each.</p>
                </div>
                <input id="proof-files" type="file" multiple />
              </div>
              <button class="secondary full" id="upload-proof">Upload Proof</button>
              <div class="gallery" id="proof-gallery"></div>
              <div class="callout" id="reviewer-feedback"></div>
              <button class="primary full" id="submit-proof">Submit Proof & Notify Reviewer</button>
            </div>
          </div>
        </section>

        <section class="content hidden" id="screen-reviewer-queue">
          <div class="card">
            <h3>Reviewer Queue</h3>
            <div class="alert info" id="queue-alert">
              <strong>New proof submitted.</strong> <span id="queue-alert-text"></span>
              <button class="link" id="queue-alert-action">View submission</button>
            </div>
            <div class="queue" id="reviewer-queue-list"></div>
          </div>
        </section>

        <section class="content hidden" id="screen-admin">
          <div class="grid two">
            <div class="card">
              <h3>Admin Overview</h3>
              <div class="filter-grid">
                <label class="field">
                  Auditor (ROS)
                  <select id="admin-filter-auditor"></select>
                </label>
                <label class="field">
                  Store
                  <select id="admin-filter-store"></select>
                </label>
                <label class="field">
                  Status
                  <select id="admin-filter-status">
                    <option value="all">All</option>
                    <option value="open">Open</option>
                    <option value="complete">Complete</option>
                  </select>
                </label>
                <label class="field">
                  From
                  <input id="admin-filter-start" type="date" />
                </label>
                <label class="field">
                  To
                  <input id="admin-filter-end" type="date" />
                </label>
              </div>
              <div class="table compact">
                <div class="table-row header">
                  <span>Audit</span>
                  <span>Store</span>
                  <span>Auditor</span>
                  <span>Tasks</span>
                  <span>Status</span>
                </div>
                <div id="admin-audit-rows"></div>
              </div>
            </div>
            <div class="card">
              <h3>Admin Access & Profiles</h3>
              <p class="muted">
                Admin access is based on the Microsoft 365 profiles synced into the directory.
              </p>
              <div class="profile-list" id="profile-list"></div>
            </div>
          </div>
        </section>
      </main>
    </div>
    <div class="app app--store-manager hidden">
      <header class="store-manager-topbar">
        <div class="store-manager-brand">
          <span class="brand-mark">AF</span>
          <div>
            <p class="eyebrow">Store Manager Workspace</p>
            <h2 id="store-manager-title">My Assigned Tasks</h2>
            <p id="store-manager-subtitle">Upload proof and submit tasks to the reviewer queue.</p>
          </div>
        </div>
        <div class="store-manager-actions">
          <label class="field compact" id="store-manager-language-field">
            <span class="muted" id="store-manager-language-label">Language</span>
            <select id="store-manager-locale">
              <option value="en">English</option>
              <option value="fr">Français</option>
            </select>
          </label>
          <button class="secondary" id="admin-message-reviewer-button">Message Reviewer</button>
        </div>
      </header>
      <main class="store-manager-main">
        <section class="content hidden" id="screen-store-manager">
          <div class="card manager-header" id="manager-audit-header"></div>
          <div class="card">
            <div class="table-header">
              <div>
                <h3>Task Overview</h3>
                <p class="muted">Stay on top of due dates and proof submissions.</p>
              </div>
            </div>
            <div class="manager-task-list" id="manager-task-list"></div>
          </div>
        </section>
      </main>
    </div>

    <script type="module" src="admin.js"></script>
    <datalist id="assignee-list"></datalist>
  </body>
</html>
